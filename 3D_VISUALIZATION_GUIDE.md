# 3D μ‹κ°ν™” + ν¬μ μ •λ³΄ κ°€μ΄λ“

**κΈ°λ¥**: PCD ν¬μΈνΈ ν΄λΌμ°λ“λ¥Ό 3Dλ΅ ν‘μ‹ν•λ©΄μ„ μ΄λ―Έμ§€μ— ν¬μλ μμ—­μ„ μƒ‰μƒμΌλ΅ κ°•μ΅°

---

## 1. μƒ‰μƒ λ²”λ΅€

### ν¬μΈνΈ μƒ‰μƒ μλ―Έ

```
π”΄ λΉ¨κ°„μƒ‰ (Red)
   β””β”€ μ΄λ―Έμ§€μ— μ„±κ³µμ μΌλ΅ ν¬μλ ν¬μΈνΈ
   β””β”€ "μ΄λ―Έμ§€μ— λ‚νƒ€λ‚λ” λ¶€λ¶„"μ„ μλ―Έ

π΅ λ…Έλ€μƒ‰ (Yellow)
   β””β”€ μΉ΄λ©”λΌ μ•μ½μ΄μ§€λ§ μ΄λ―Έμ§€ λ²”μ„ λ°–
   β””β”€ "μΉ΄λ©”λΌκ°€ λ°”λΌλ³΄μ§€λ§ μ΄λ―Έμ§€ κ²½κ³„ λ°–"

β« νμƒ‰ (Gray)
   β””β”€ μΉ΄λ©”λΌ λ’¤μ½ (ν¬μ λ¶κ°€λ¥)
   β””β”€ "μΉ΄λ©”λΌ λ°λ€ λ°©ν–¥" ν¬μΈνΈ

π”µ νλ€μƒ‰ (Blue)
   β””β”€ κΈ°νƒ€ ν¬μΈνΈ
```

---

## 2. μ‚¬μ© λ°©λ²•

### 2.1 μλ™ μ‹¤ν–‰

```bash
python visualize_pcd.py
```

μ‹¤ν–‰ κ³Όμ •:
```
[1] νμΌ ν™•μΈ
[2] PCD λ΅λ“
[3] μ΄λ―Έμ§€ λ΅λ“
[4] μΉ΄λ©”λΌ λ³΄μ • μ„¤μ •
[5] ν¬μΈνΈ ν΄λΌμ°λ“ ν¬μ
[6] κ²°κ³Ό μ €μ¥
[7] ν†µκ³„
[8] μ¶”κ°€ μ‹κ°ν™”
  β†’ "ν¬μ μ •λ³΄λ¥Ό ν¬ν•¨ν• 3D μ‹κ°ν™”λ¥Ό ν•μ‹κ² μµλ‹κΉ? (y/n):"
```

### 2.2 3D μ‹κ°ν™” μ‹μ‘

ν”„λ΅¬ν”„νΈμ—μ„ `y`λ¥Ό μ…λ ¥ν•λ©΄:

```
[7] 3D μ‹κ°ν™” + ν¬μ μ •λ³΄
======================================================================
  ν¬μΈνΈ: 50,000κ°
  μΉ΄λ©”λΌ μ•: 35,000κ° (70.0%)
  μ΄λ―Έμ§€ λ²”μ„: 28,000κ° (56.0%)

  λ²”λ΅€ (ν¬μΈνΈ μƒ‰μƒ):
    π”΄ λΉ¨κ°„μƒ‰ (Red): μ΄λ―Έμ§€μ— ν¬μλ ν¬μΈνΈ
    π΅ λ…Έλ€μƒ‰ (Yellow): μΉ΄λ©”λΌ μ•μ΄μ§€λ§ μ΄λ―Έμ§€ λ²”μ„ λ°–
    β« νμƒ‰ (Gray): μΉ΄λ©”λΌ λ’¤μ½

  Open3D μλ„μ°λ¥Ό μ—΄κ³  μμµλ‹λ‹¤...
  λ§μ°μ¤λ΅ 3D λ¨λΈμ„ νμ „ν•  μ μμµλ‹λ‹¤.
```

---

## 3. Open3D μλ„μ° μ΅°μ‘

### λ§μ°μ¤ μ΅°μ‘

| λ™μ‘ | κΈ°λ¥ |
|------|------|
| μΆν΄λ¦­ + λ“λκ·Έ | νμ „ |
| μ°ν΄λ¦­ + λ“λκ·Έ | μ΄λ™ (Pan) |
| μ¤ν¬λ΅¤ | μ¤ (Zoom) |
| `[`/`]` | λ°°κ²½μƒ‰ λ³€κ²½ |

### ν‚¤λ³΄λ“ μ΅°μ‘

| ν‚¤ | κΈ°λ¥ |
|:--:|------|
| `h` | ν—¬ν”„ ν‘μ‹ |
| `p` | ν¬μΈνΈ ν¬κΈ° μ¦κ°€ |
| `m` | ν¬μΈνΈ ν¬κΈ° κ°μ† |
| `r` | λ·° λ¦¬μ…‹ |
| `q` | μλ„μ° λ‹«κΈ° |

---

## 4. μ‹¤μ  μμ‹

### 4.1 μΆμΈ΅ ν™”λ©΄ (2D ν¬μ)

```
Original Image (1920Γ—1536)
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ λ…Έλ€μƒ‰ μ λ“¤: μ΄λ―Έμ§€ λ²”μ„ λ°–  β”‚
β”‚ λΉ¨κ°„μƒ‰ μ λ“¤: ν¬μ μ™„λ£       β”‚
β”‚ (κ±°λ¦¬μ— λ”°λ¥Έ μƒ‰μƒ: νλ€β†’λΉ¨κ°•) β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### 4.2 μ°μΈ΅ ν™”λ©΄ (3D μ‹κ°ν™”)

```
Open3D Window (1200Γ—800)
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  π”΄ λΉ¨κ°„ μ λ“¤            β”‚
β”‚    β†“ μ΄λ―Έμ§€μ— λ³΄μ΄λ” λ¶€λ¶„   β”‚
β”‚  π΅ λ…Έλ€ μ λ“¤            β”‚
β”‚    β†“ μΉ΄λ©”λΌ λ°– λ¶€λ¶„      β”‚
β”‚  β« νμƒ‰ μ λ“¤            β”‚
β”‚    β†“ μΉ΄λ©”λΌ λ’¤            β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## 5. λ¶„μ„ ν™μ©

### 5.1 ν¬μ μ„±κ³µλ¥  ν™•μΈ

```
μΉ΄λ©”λΌ μ•: 35,000κ° (70.0%)
μ΄λ―Έμ§€ λ²”μ„: 28,000κ° (56.0%)
```

**μλ―Έ**:
- μ „μ²΄ ν¬μΈνΈμ 70%κ°€ μΉ΄λ©”λΌ μ •λ©΄
- κ·Έ μ¤‘ 56%κ°€ μ‹¤μ  μ΄λ―Έμ§€μ— λ‚νƒ€λ‚¨

### 5.2 λ¬Έμ  μ§„λ‹¨

**λΉ¨κ°„ ν¬μΈνΈκ°€ μ λ‹¤λ©΄?**
- μΉ΄λ©”λΌμ™€ LiDARμ μ •λ ¬μ΄ μ• λ¨
- Extrinsic ν–‰λ ¬ ν™•μΈ ν•„μ”

**λ…Έλ€ ν¬μΈνΈκ°€ λ§λ‹¤λ©΄?**
- μΉ΄λ©”λΌμ μ‹μ•Όκ°μ΄ LiDARλ³΄λ‹¤ μΆμ
- Wide-angle λ μ¦ κ³ λ ¤ ν•„μ”

**νμƒ‰ ν¬μΈνΈκ°€ λ§λ‹¤λ©΄?**
- λ’¤μ½ LiDAR λ°μ΄ν„° (μΉ΄λ©”λΌ λ’¤)
- λ©€ν‹° μΉ΄λ©”λΌ μ„¤μ • κ³ λ ¤

---

## 6. ν†µν•© μ‚¬μ© μμ‹

### μ‹λ‚λ¦¬μ¤: μΉ΄λ©”λΌ-LiDAR μ •λ ¬ κ²€μ¦

```bash
# Step 1: 3D μ‹κ°ν™” μ‹¤ν–‰
python visualize_pcd.py
β†’ y (3D μ‹κ°ν™” μ„ νƒ)

# Step 2: μƒ‰μƒ λ¶„μ„
# - λΉ¨κ°„ μ λ“¤μ΄ μ΄λ―Έμ§€ μ¤‘μ•™μ— μ§‘μ¤‘λμ–΄ μλ‚?
# - μ› μμ—­μ΄ κ· λ“±ν•κ² λ¶„ν¬λμ–΄ μλ‚?

# Step 3: μΆν‘κ³„ ν™•μΈ
# - νμƒ‰ μ λ“¤μ μ„μΉκ°€ μΉ΄λ©”λΌ λ’¤μ½μΈκ°€?
# - λ…Έλ€ μ λ“¤μ΄ μ΄λ―Έμ§€ κ²½κ³„ κ·Όμ²μΈκ°€?

# Step 4: μ •λ ¬ κ²°κ³Ό
# β… μΆ‹μ: λΉ¨κ°„ μ  > 70%, νμƒ‰ μ  < 20%
# β οΈ  λ³΄ν†µ: λΉ¨κ°„ μ  50-70%, νμƒ‰ μ  20-40%
# β λ‚μ¨: λΉ¨κ°„ μ  < 50%, νμƒ‰ μ  > 40%
```

---

## 7. μ½”λ“ ν™μ©

### 7.1 Pythonμ—μ„ ν”„λ΅κ·Έλλ° μ‚¬μ©

```python
from pathlib import Path
from visualize_pcd import visualize_pcd_3d_with_projection, CalibrationDB, DEFAULT_CALIB, DEFAULT_LIDAR_TO_WORLD_v3

pcd_path = Path("synchronized_data_pangyo_optimized/pcd/0000050000.pcd")
image_path = Path("synchronized_data_pangyo_optimized/img/0000050000.jpg")

calib_db = CalibrationDB(DEFAULT_CALIB, lidar_to_world=DEFAULT_LIDAR_TO_WORLD_v3)

visualize_pcd_3d_with_projection(
    pcd_path=pcd_path,
    image_path=image_path,
    calib_db=calib_db,
    camera_name="a6",
    max_distance=50.0
)
```

### 7.2 λ°°μΉ μ²λ¦¬

```python
from pathlib import Path

pcd_dir = Path("synchronized_data_pangyo_optimized/pcd")
img_dir = Path("synchronized_data_pangyo_optimized/img")

for pcd_file in sorted(pcd_dir.glob("*.pcd"))[:10]:  # μ²μ 10κ°
    img_file = img_dir / pcd_file.with_suffix(".jpg").name
    if img_file.exists():
        visualize_pcd_3d_with_projection(pcd_file, img_file, calib_db)
```

---

## 8. μµμ… μ„¤μ •

### λ©”μΈ ν•¨μμ—μ„ μμ • κ°€λ¥

```python
# visualize_pcd.pyμ main() ν•¨μ λ‚΄

# ν¬μΈνΈ κ°μ μ΅°μ •
pcd_filename = "0000050000"  # μ›ν•λ” νμΌλ…

# μΉ΄λ©”λΌ μ„ νƒ
camera_name = "a6"

# μµλ€ κ±°λ¦¬ (μƒ‰μƒ λ²”μ„)
max_distance = 50.0  # λ―Έν„°

# μ΄λ―Έμ§€ μ„μ ν¬μΈνΈ λ°κ²½
point_radius = 3  # ν”½μ…€
```

---

## 9. λ¬Έμ  ν•΄κ²°

### Q: 3D μλ„μ°κ°€ μ• μ—΄λ¦°λ‹¤
**A**: open3dκ°€ μ„¤μΉλμ§€ μ•μ•μ„ κ°€λ¥μ„±
```bash
pip install open3d
```

### Q: λ¨λ“  ν¬μΈνΈκ°€ νμƒ‰μ΄λ‹¤
**A**: Extrinsic ν–‰λ ¬μ΄ μλ»λμ—μ„ κ°€λ¥μ„±
- ref_calibration_data.pyμ κ°’ ν™•μΈ
- μΆν‘μ¶• λ°©ν–¥ ν™•μΈ (X: μ •λ©΄, Y: μ¤λ¥Έμ½, Z: μ•„λ)

### Q: λΉ¨κ°„ ν¬μΈνΈκ°€ μ΄μƒν• μ„μΉμ— μλ‹¤
**A**: Intrinsic νλΌλ―Έν„° ν™•μΈ
- s, div κ°’μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ
- μ΄λ―Έμ§€ ν¬κΈ° (1920Γ—1536) μΌμΉ ν™•μΈ

---

## 10. μ„±λ¥ μ •λ³΄

| ν•­λ© | κ°’ |
|------|-----|
| ν¬μΈνΈ 50K | ~2μ΄ |
| ν¬μΈνΈ 100K | ~4μ΄ |
| ν¬μΈνΈ 500K | ~15μ΄ |
| λ©”λ¨λ¦¬ | ~100MB (50K ν¬μΈνΈ κΈ°μ¤€) |

---

## μ •λ¦¬

**μ΄ κΈ°λ¥μ μ¥μ **:
β… 2D ν¬μκ³Ό 3D μ„μΉλ¥Ό λ™μ‹μ— ν™•μΈ  
β… μΉ΄λ©”λΌ-LiDAR μ •λ ¬ μƒνƒ μ‹κ°μ  κ²€μ¦  
β… λ¬Έμ  μ›μΈ νμ•… μ©μ΄ (μƒ‰μƒμΌλ΅ κµ¬λ¶„)  
β… λ€ν™”ν•μΌλ΅ κ°λ„λ¥Ό λ°”κΏ”κ°€λ©° ν™•μΈ κ°€λ¥

